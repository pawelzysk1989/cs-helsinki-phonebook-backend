var x=Object.defineProperty;var g=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var N=(t,e,n)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,b=(t,e)=>{for(var n in e||(e={}))_.call(e,n)&&N(t,n,e[n]);if(g)for(var n of g(e))$.call(e,n)&&N(t,n,e[n]);return t};import{R as a,r as u,a as d,b as L}from"./vendor.7f4d3e88.js";const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}};D();function k({notification:{type:t,message:e}}){return a.createElement("div",{className:`notification notification--${t}`},a.createElement("span",{className:"notification__message"},e))}function A({notifications:t}){return a.createElement("div",{className:"notifications"},t.map(e=>a.createElement(k,{key:e.message,notification:e})))}const y=({label:t,value:e,onChange:n})=>{const o=s=>n(s.target.value);return a.createElement("label",{className:"form-field"},a.createElement("span",{className:"form-field__label"},t),a.createElement("input",{className:"form-field__control",value:e,onChange:o}))},O=({onSubmit:t})=>{const[e,n]=u.exports.useState(""),[o,s]=u.exports.useState(""),c=p=>{p.preventDefault(),t({name:e,number:o},()=>{n(""),s("")})},i=!(e&&o);return a.createElement("form",{className:"form",onSubmit:c},a.createElement(y,{label:"name",value:e,onChange:n}),a.createElement(y,{label:"number",value:o,onChange:s}),a.createElement("button",{type:"submit",className:"form-button",disabled:i},"add"))},I=({person:{name:t,number:e},onDelete:n})=>a.createElement("tr",{className:"table-row"},a.createElement("td",{className:"table-cell"},t),a.createElement("td",{className:"table-cell"},e),a.createElement("td",{className:"table-cell"},a.createElement("button",{onClick:n},"delete"))),M=({persons:t,onDelete:e})=>a.createElement("table",{className:"table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{className:"table-hd-cell"},"Name"),a.createElement("th",{className:"table-hd-cell"},"Number"))),a.createElement("tbody",null,t.map(n=>a.createElement(I,{key:n.id,person:n,onDelete:()=>e(n)})))),R=({search:t,onSearchChange:e})=>{const n=o=>{e(o.target.value)};return a.createElement("input",{value:t,onChange:n,placeholder:"filter by name"})},v=({title:t,children:e})=>a.createElement("section",{className:"section"},a.createElement("h2",{className:"section__header"},t),a.createElement("div",{className:"section_body"},e)),f="api/persons",B=()=>d.get(f).then(({data:e})=>e),F=t=>d.post(f,t).then(({data:n})=>n),j=t=>d.put(`${f}/${t.id}`,t).then(({data:n})=>n),K=t=>d.delete(`${f}/${t.id}`).then(({data:n})=>n).catch(n=>{var o;throw Error(((o=n.response)==null?void 0:o.status)===404?`Person ${t.name} was already removed from the server`:n.message)});var h={getAll:B,create:F,update:j,delete:K};const T=()=>{const[t,e]=u.exports.useState([]),[n,o]=u.exports.useState([]),[s,c]=u.exports.useState("");u.exports.useEffect(()=>{h.getAll().then(e)},[]);const i=r=>{c(r)},p=t.filter(r=>r.name.toLowerCase().includes(s.toLowerCase())),E=r=>{o(n.concat(r)),setTimeout(()=>{const l=n.filter(({message:m})=>m!==r.message);o(l)},5e3)},P=r=>{window.confirm(`Delete ${r.name}?`)&&h.delete(r).then(()=>{e(t.filter(l=>l.id!==r.id))}).catch(l=>{E({type:"error",message:l.message})})},S=r=>{h.create(r).then(l=>{E({type:"success",message:`Added ${l.name}`}),e(t.concat(l))})},w=r=>{h.update(r).then(l=>{e(t.map(m=>m.id!==l.id?m:l))})},C=(r,l)=>{const m=t.find(q=>q.name===r.name);m?window.confirm(`${r.name} is already added to Phonebook, replace the old number with the new on`)&&(l(),w(b(b({},m),r))):(l(),S(r))};return a.createElement(a.Fragment,null,Boolean(n.length)&&a.createElement(A,{notifications:n}),a.createElement(v,{title:"Phonebook"},a.createElement(O,{onSubmit:C})),a.createElement(v,{title:"Numbers"},a.createElement(R,{search:s,onSearchChange:i}),a.createElement(M,{persons:p,onDelete:P})))};L.render(a.createElement(a.StrictMode,null,a.createElement(T,null)),document.getElementById("root"));
